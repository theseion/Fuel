<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Often, we need to load objects whose class has changed since it was saved. In this document how to load them in the different cases. The figure below is useful to explain some of them. Imagine we serialized an instance of Point and we need to materialize it when Point class has changed.
ShapeChanges #  Let&rsquo;s start with the easier cases. If a variable was inserted, its value will be nil."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content><meta property="og:description" content="Often, we need to load objects whose class has changed since it was saved. In this document how to load them in the different cases. The figure below is useful to explain some of them. Imagine we serialized an instance of Point and we need to materialize it when Point class has changed.
ShapeChanges #  Let&rsquo;s start with the easier cases. If a variable was inserted, its value will be nil."><meta property="og:type" content="article"><meta property="og:url" content="https://theseion.github.io/Fuel/migration/"><meta property="article:section" content><title>Migration | Fuel</title><link rel=manifest href=/Fuel/manifest.json><link rel=icon href=/Fuel/favicon.png type=image/x-icon><link rel=stylesheet href=/Fuel/book.min.4161ce72491bec8afb94acd3b81e1480e4774aca5e9e3e25c4eeeb0a4dff856a.css integrity="sha256-QWHOckkb7Ir7lKzTuB4UgOR3Sspenj4lxO7rCk3/hWo=" crossorigin=anonymous><script defer src=/Fuel/flexsearch.min.js></script><script defer src=/Fuel/en.search.min.a05254d35db10f479c6a2cd25c3c289b79e0f47f07577bedea5fb6ceacb44f29.js integrity="sha256-oFJU012xD0ecaizSXDwom3ng9H8HV3vt6l+2zqy0Tyk=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a href=/Fuel/><img src=/Fuel/logo-fuel-header.png alt=Logo><span>Fuel</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li><a href=https://theseion.github.io/Fuel/builtin-header-support/>Builtin Header Support</a></li><li><a href=https://theseion.github.io/Fuel/customizing-the-graph/>Customizing the Graph</a></li><li><a href=https://theseion.github.io/Fuel/debugging/>Debugging</a></li><li><a href=https://theseion.github.io/Fuel/errors/>Errors</a></li><li><a href=https://theseion.github.io/Fuel/format-migration/>Format Migration</a></li><li><a href=https://theseion.github.io/Fuel/managing-globals/>Managing Globals</a></li><li><a href=https://theseion.github.io/Fuel/migration/ class=active>Migration</a></li><li><a href=https://theseion.github.io/Fuel/package-overview/>Package Overview</a></li><li><span>Releases</span><ul><li><a href=https://theseion.github.io/Fuel/releases/1.9/>1.9</a></li><li><a href=https://theseion.github.io/Fuel/releases/1.8/>1.8</a></li><li><a href=https://theseion.github.io/Fuel/releases/1.8.1/>1.8.1</a></li><li><a href=https://theseion.github.io/Fuel/releases/1.7/>1.7</a></li><li><a href=https://theseion.github.io/Fuel/releases/1.6/>1.6</a></li><li><a href=https://theseion.github.io/Fuel/releases/1.5/>1.5</a></li><li><a href=https://theseion.github.io/Fuel/releases/1.4/>1.4</a></li></ul></li></ul></nav><script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/Fuel/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Migration</strong>
<label for=toc-control><img src=/Fuel/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents></nav></aside></header><article class=markdown><p>Often, we need to load objects whose class has changed since it was saved. In this document how to load them in the different cases. The figure below is useful to explain some of them. Imagine we serialized an instance of Point and we need to materialize it when Point class has changed.</p><h1 id=shapechanges>ShapeChanges
<a class=anchor href=#shapechanges>#</a></h1><p>Let&rsquo;s start with the easier cases. If a variable was inserted, its value will be nil. If removed, it is also obvious: the serialized value will be ignored. In the case the variables are the same the the order changed, Fuel also tolerates it automatically.A more interesting case is when a variable was renamed, where the user can map old names to new ones. In our example:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-smalltalk data-lang=smalltalk><span style=color:#a6e22e>FLMaterializer</span> <span style=color:#a6e22e>newDefault</span>
	<span style=color:#a6e22e>migrateClassNamed:</span> <span style=color:#e6db74>#Point</span>
	<span style=color:#a6e22e>variables:</span> {<span style=color:#e6db74>&#39;x&#39;</span> <span style=color:#a6e22e>-&gt;</span> <span style=color:#e6db74>&#39;posX&#39;</span>. <span style=color:#e6db74>&#39;y&#39;</span> <span style=color:#a6e22e>-&gt;</span> <span style=color:#e6db74>&#39;posY&#39;</span>}.
</code></pre></div><p>Not surprisingly, if nothing specified the change will be understood by Fuel as two independent operations, an insertion and a removal.The last change in the figure is a class rename. This should be specified this way:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-smalltalk data-lang=smalltalk><span style=color:#a6e22e>FLMaterializer</span> <span style=color:#a6e22e>newDefault</span>
	<span style=color:#a6e22e>migrateClassNamed:</span> <span style=color:#e6db74>#Point</span>
	<span style=color:#a6e22e>toClass:</span> <span style=color:#a6e22e>Coordinate</span>.
</code></pre></div><p>It is also available <code>#migrateClassNamed:toClass:variables:</code> to combine both class and variable rename.Although not illustrated in the figure, a class could also change its layout. For example, Point could change from being fixed to variable. This should be also automatically tolerated by Fuel. Unfortunately, the inverse (variable to fixed) is not supported so far.You can find tests related to this guide in <code>FLMigrationTest</code>. Additionally, the method globalEnvironment:, showed in Managing Globals, might be useful for migrations: you can prepare an ad-hoc environment dictionary with the same keys that were used during serialization, but with the new classes as values.</p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/theseion/Fuel/commit/30f646158dec95bc10995c12d702a06ef16da709 title="Last modified by Max Leske | Jun 11, 2021" target=_blank rel=noopener><img src=/Fuel/svg/calendar.svg class=book-icon alt=Calendar>
<span>Jun 11, 2021</span></a></div></div><script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents></nav></div></aside></main></body></html>